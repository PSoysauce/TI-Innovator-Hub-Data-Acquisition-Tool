var activeChannels=6;function generate(e){var t=Math.round(1*Math.random());return triggerManager(e),thresholdManager(e),t}function hideChannel(e){var t=document.getElementById("channelChart"+e),a=document.getElementById("channelToggle"+e),n=document.getElementById("channelSettings"+e);document.getElementById("timing");"none"==t.style.display?(a.style.color="white",a.style.backgroundColor="#c00",t.style.display="block",n.style.display="block",activeChannels++):(a.style.color="black",a.style.backgroundColor="white",t.style.display="none",n.style.display="none",activeChannels--)}function pauseButton(e){var t=document.getElementById("pause"+e),a=Chart.instances[e];"Pause"==t.innerHTML?(t.innerHTML="Start",a.options.scales.xAxes[0].realtime.pause=!0,a.update({duration:0})):"Start"==t.innerHTML&&(t.innerHTML="Pause",a.options.scales.xAxes[0].realtime.pause=!1,a.update({duration:0}))}function pauseAll(){for(var e=document.getElementById("pauseAll"),t=0;t<6;t++)pauseButton(t);"Pause All Charts"==e.innerHTML?e.innerHTML="Start All Charts":e.innerHTML="Pause All Charts"}function exportCVS(){const e=[];e.push(["Chart ID,Time,Voltage"].join(","));for(var t=0;t<6;t++)Chart.instances[t].data.datasets[1].data.forEach((function(a){var n=new Date(a.x).toString().replace("GMT-0500 (Central Daylight Time)","");e.push([t+1,n,a.y])}));download(e.join("\n"))}const download=function(e){const t=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download","download.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n)};function triggerManager(e){Chart.instances[e];var t=document.getElementById("trigger");if("Pattern Trigger"==t.options[t.selectedIndex].text){var a=document.getElementById("pattern").value;if(null==a)return;1==validatePattern(a)&&patternTrigger(e,a)}}function findPattern(e,t){var a=[];e.data.datasets[1].data.forEach((function(e){a.push(e.y)}));var n=a.join("");return-1!=n.indexOf(t)?n.indexOf(t.toString()):-1}function validatePattern(e){for(i=0;i<e.length;i++)return"1"!=e[i]&&"0"!=e[i]?-1:1}function patternTrigger(e,t){var a=Chart.instances[e];if(index=findPattern(a,t),-1==index)return-1;for(var n=index;n<t.length+index;n++)a.data.datasets[0].data.push({x:a.data.datasets[1].data[n].x,y:a.data.datasets[1].data[n].y})}function thresholdManager(e){var t=Chart.instances[e];threshold=document.getElementById("threshold"),threshold.addEventListener("change",(function(e){t.data.datasets[2].data=[]})),thresholdValue=threshold.value,t.data.datasets[1].data.forEach((function(e){thresholdValue>0&&t.data.datasets[2].data.push({x:e.x,y:thresholdValue})}))}function generateCharts(){for(var e=0;e<6;e++){var t=document.getElementById("channelChart"+e).getContext("2d");new Chart(t,{type:"line",data:{datasets:[{label:"Pattern",pointStyle:"circle",data:[],steppedLine:!1,showLine:!1,fill:!1,borderColor:"rgb(255, 255, 255)",pointBorderColor:"rgb(255, 255, 255)",pointBackgroundColor:"rgb(255, 255, 255)",pointRadius:5,pointHoverRadius:5},{label:"Voltage",pointStyle:"line",data:[],steppedLine:!0,fill:!1,borderColor:"rgb(14, 173, 105)"},{label:"Threshold",pointStyle:"line",data:[],steppedLine:!1,fill:!1,borderColor:"green"}]},options:{responsive:!0,title:{display:!0,text:"Channel "+(e+1),fontColor:"rgb(255, 255, 255)"},legend:{display:!1,labels:{defaultFontFamily:"'Roboto', 'Franklin Gothic Medium', 'Tahoma', 'sans-serif",fontColor:"rgb(255, 255, 255)"}},showTooltips:!1,scales:{yAxes:[{gridLines:{drawOnChartArea:!1},ticks:{beginAtZero:!0,fontColor:"rgb(255, 255, 255)"}}],xAxes:[{gridLines:{drawOnChartArea:!1},ticks:{beginAtZero:!0,fontColor:"rgb(255, 255, 255)"},type:"realtime",realtime:{onRefresh:function(e){0==e.options.scales.xAxes[0].realtime.pause&&e.data.datasets[1].data.push({x:Date.now(),y:generate(e.id)})},delay:2e3,pause:!0}}]}}})}}generateCharts();